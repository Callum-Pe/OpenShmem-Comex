#!/bin/sh
#
# generated from OpenSHMEM src directory, don't edit installed version
#
prog="`basename $0`"
case $# in
  0)
    echo "Usage: $prog [MPI options] -np PEs program"
    exit 1
    ;;
  *)
    ;;
esac

#
# pass through args, trap -np N
#
args=""
while [ $# -gt 0 ]
do
  case "$1" in
      -np)
	  shift
	  npes=$1
	  ;;
      *)
	  args="$args $1"
	  ;;
  esac
  shift
done

case "@GASNET_CONDUIT@" in
    smp)
	RUN_IT="env GASNET_PSHM_NODES=$npes"
	;;
    mpi|ibv)
	RUN_IT="@GASNET_LD@"
	# set number of PEs if provided (or may come from job scheduler)
	[ "$npes" ] && RUN_IT="$RUN_IT -np $npes"
	;;
    *)
	;;
esac

exec $RUN_IT $args
