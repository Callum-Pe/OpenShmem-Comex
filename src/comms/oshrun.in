#!/bin/sh
#
# generated from OpenSHMEM src directory, don't edit installed version
#

progname="`basename $0`"

show_usage_and_exit()
{
  echo "Usage: $progname [conduit options] -np PEs program"
  exit 1
}

if [ $# -eq 0 ]
then
  show_usage_and_exit
fi

#
# pass through args, trap -np N
#

npes=""
args=""

while [ $# -gt 0 ]
do
  case "$1" in
      -np)
	  shift
	  npes=$1
	  ;;
      *)
          args="$args $1"
	  ;;
  esac
  shift
done

if [ "$npes" ]
then
  case "$npes" in
    [0-9]*)
      # good, user-supplied
      ;;
     *)
      show_usage_and_exit
      ;;
  esac
fi

OPENSHMEM_GASNET_CONDUIT="@GASNET_CONDUIT@"
export OPENSHMEM_GASNET_CONDUIT

case "@GASNET_CONDUIT@" in
    smp)
	RUN_IT="env GASNET_PSHM_NODES=$npes $args"
<<<<<<< HEAD
        ;;
    udp)
	RUN_IT="$args"
=======
	;;
    udp)
	RUN_IT="env GASNET_UDP_NODES=$npes $args"
>>>>>>> cc2c1df84a2c50bccf7600453a807da6615698f5
        ;;
    mpi|ibv)
	RUN_IT="@GASNET_LD@"
	# set number of PEs if provided (or may come from job scheduler)
	if [ "$npes" ]
        then
          RUN_IT="$RUN_IT -np $npes"
        fi
        RUN_IT="$RUN_IT $args"
	;;
    *)
	;;
esac

$RUN_IT
